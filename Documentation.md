#Documentation
This is the documentation for cvfit. This documentation will contain three parts, the main program and two modules **toolkit** and **hillequation**.
##Toolkit
**Toolkit** is as its name suggests a small bundle of tools which is irrelevant from the direct fitting process. There are currently two main components in this module.

The first component is a class `Report`. This class is a bundle of tools to convert content to *markdown* and then export as html.
Use `Report(filename)` to create a Report object. The filename is the path of the file plus its name (Format: path/name **without file extension**)
This object has several methods to create title, paragraph, insert illustrations or even insert table from numpy array.
> Methods:

> - `.title(title text, title number)`: Using this method to create a title.
>  - *title text* means the text of the title. This should be a string such as `'This is a title!'`
>  - *title number* means the level of the title. This should be a integer such as 1, 2, 3. The maxium number is 6.
> - `.paragraph(paragraph text)`: Using this method to create a paragraph. *paragraph text* should be a string such as `â€˜This is a paragraph.'`
> - `.image(image file)`: Using this method to add a image. The `image file` is the location of the file and is also a string such as `'path/image.png'`
> - `.tabletitle(title list)`: Using this method to add a title to a table. `title list` can either be a list of string or a numpy array of string such as `['title 1', 'title 2', 'title 3']`
> - `.table(nparray)`: Using this method to add content to a table. The `nparray` as its name suggesting is a numpy array suchas `array([[1, 2, 3], [4, 5, 6]])`. 
> - `.outputhtml()`: Using this method to generate a html file as well as markdown file.
> - `.close()`: Using this method to generate a markdown file without generating a html file.

The second component is a function `check_input(text, accept value, default)`. This function is aimed to force the user to only key in the desirable value but not others and return the integer of that value. If no input is detected, it will return the default value. The argument `text` is a string to be displayed before the key in section such as `'Mode 1 or 2?'`. The argument `accept value` is a list of **string** which can be accepted such as `['1', '2']`. The argument `default` is the an integer to return when no input is detected.

##Hill Equation
The module `hillequation` as its name suggesting is a module for fitting the data to hill equation.
This module contain one class, its subclass and three functions (Hill equation itself, weighted residual of Hill equation and final function which does the whole fitting)

The class `Cell` is the master class. To create this object use `Cell(concentration, response)`. The concentration here is a numpy array of concentration and the response is also a numpy array of the responses. By create this object, the concentration and the responses will be sorted according to the concentration.
This object has four attributes. 
 - `.originalconcentration` is the original input of concentration
 - `.originalresponse` is the original input of reponses
 - `.concentration` is the sorted concentration
 - `.response` is the response corresponding to the sorted concentration
 
 The class `HillEquation` is the child class of the `Cell` obeject. To create this object, use `HillEquation(Cell)`. the `Cell` here is the Cell object created previously.

The method `.set_condition_hillequation()` is used for setting the conditions for the fitting. By calling this method, user will need to input the conditions in to the console. Five attributes will be created after call this method.
- `.weightmode` is the weighting mode for the fitting. Currently, only two method is implemented. The first is equally weighted method `1` and the second is weighted by the recipical of the standard error `2`.
- `.Component` is the component of the Hill equation. Currently only one component (`1`) is implemented.
- `.trend` is the trend of the Hill equation. It can be `1` which means the response increases with concentration and `-1` means the response decrease with the concentration
- `.YminFixed` is whether to fix Ymin or not. `0` means not fixing and `1` means fixing. If `.trend` is `1`, fixing Ymin means Y(0) is 0. If `.trend` is `-1`, fixing Ymin means Y(inf) is 0.
- `.YmaxFixed` is whether to fix Ymax or not. This attribute is generated by progaram, not by user. The meaning of this attribute is that when fitting Hill equation with normalised data, Ymax is fixed to 1. The way this works is similar to `.YminFixed`, If `.trend` is `1`, fixing Ymax means Y(inf) is 1. If `.trend` is `-1`, fixing Ymax means Y(0) is 1.
*Requirements: `.concentration`, `.response`*

The method `.directset_condition_hillequation(weightmode, Component, trend, YminFixed, YmaxFixed)` provides an alternative way to directly set the five attributes. Since they are necessary for the following steps.

The method `.hill_equation_guess()` generates the guess for fitting process. After calling this method, attribute `.guess` is generated.
*Requirements:  `.concentration`, `.response`, `.trend`, `.YminFixed`, `.YmaxFixed`, `.Component`,  `.weightmode`*

The method `.fitting_hill_equation()` will start fitting process. After calling this method, attribute `.weight` and `.coeffs` is generated. `.weight` is an array which has the same size of `.concentration` and `.response` and indicates the weight of each response.
*Requirements:  `.concentration`, `.response`, `.trend`, `.YminFixed`, `.YmaxFixed`, `.Component`,  `.weightmode`, `.size`*

The method `.normalise_hill_equation()` will normalise the coefficients by setting Ymin to 0 and Ymax to 1. It will also normalise the response based on the Ymin and the Ymax **so there is possibility that some normalised response will be larger than 1**. After call this method, attribute `.normalised_coeffs` and `.normalised_response` will be generated. 
*Requirements:  `.response`, `.trend`, `.coeffs`*

The method `.calculate_average_standarderror()` will calculate the average response in every concentration and the standard error of these results. After call this method, attribute `.uniqueconcentration`, `.averageresponse` and `.standarderror` will be generated. **The size of these three attributes are not the same as `.concentration` and is the same as the number of different concentrations in `.concentration`.**
*Requirements:  `.concentration`, `.response`*

The method `.plot_originaldata_guess_fit(filename, index)` will plot a graph of the initial guess, fitted result and the original data. `filename` is the the path and the name of the file and index is the number of the cell being examined.
*Requirements:  `.concentration`, `.response`, `.guess`, `.Component`, `.YminFixed`*

Since different methods have different requirements, the recommend routine is 
- Create `Cell` obect
- Create `HillEquation` object 
- Call `.set_condition_hillequation()` or `.directset_condition_hillequation(weightmode, Component, trend, YminFixed, YmaxFixed)`
- Call `.hill_equation_guess()`
- Call `.fitting_hill_equation()`
- Call `.normalise_hill_equation()`

After fitting is completed merge all the normalised data together
- Create `Cell` obect
- Create `HillEquation` object 
- Call `.set_condition_hillequation()` or `.directset_condition_hillequation(weightmode, Component, trend, YminFixed, YmaxFixed)`
- Call `.hill_equation_guess()`
- Call `.fitting_hill_equation()`
- Call `.calculate_average_standarderror()`

The function `hill_equation(coeffs, concentration, Component, YminFixed, YmaxFixed)` can calculate the response based on the concentration.

The function `hill_equation_residuals(coeffs, response, weight, concentration, Component, YminFixed, YmaxFixed)` is a necesary function needed for least square fitting.

The function `fitting_curve_hill_equation(filename, celllist, report)` is a warpper of the whole process. Call this function can generate a detailed html report of the cell.